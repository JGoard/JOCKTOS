{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "build-in-docker",
      "type": "shell",
      "command": "docker",
      "args": [
        "run",
        "-v",
        "${workspaceFolder}:/app",
        "jocktos:latest",
        "/bin/sh",
        "-c",
        "cd /app/jocktos/ && make clean && make",
      ],
      "group": {
        "kind": "build",
        "isDefault": true
      }
    },
    {
      "label": "run-qemu-emulator",
      "type": "shell",
      "command": "docker",
      "args": [
        "run",
        "-d",
        "--name",
        "my_qemu_emulator",
        "--privileged",
        "-p",
        "1234:1234",
        "-v",
        "${workspaceFolder}:/app",
        "jocktos:latest",
        "/bin/sh",
        "-c",
        "qemu-system-arm -machine olimex-stm32-h405 -kernel /app/jocktos/build/main.elf -monitor none -nographic -serial stdio -s -S"
      ],
      "problemMatcher": {
        "owner": "docker",
        "fileLocation": [
          "relative",
          "${workspaceFolder}"
        ],
        "pattern": {
          "regexp": "^(.*)$",
          "message": 1
        }
      }
    },
    {
      "label": "stop-qemu-emulator",
      "type": "shell",
      "command": "docker",
      "args": [
        "rm",
        "-f",
        "my_qemu_emulator"
      ],
      "problemMatcher": {
        "owner": "docker",
        "fileLocation": [
          "relative",
          "${workspaceFolder}"
        ],
        "pattern": {
          "regexp": "^(.*)$",
          "message": 1
        }
      }
    }
  ]
}
